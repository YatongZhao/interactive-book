(this["webpackJsonpinteractive-book"]=this["webpackJsonpinteractive-book"]||[]).push([[0],{114:function(e,t,n){"use strict";n.r(t);var c=n(2),i=n(0),a=n.n(i),s=n(11),r=n.n(s),o=n(25),j=n(15),u=n(84),l=n(8),b=n(85),d=n(144),h=n(172),O=n(146),p=n(173),f=n(149),x=n(150),g=n(151),m=n(51),v=n(152),S=n(153),C=n(167),y=n(155),k=n(168),I=n(148),T=n(154),L=n(157),N=n(158),w=n(159),B=n(160),E=n(156),F=n(169),W={apiHost:"",phoneRegExp:/^1[3|4|5|7|8][0-9]{9}$/,passwordRegExp:/(?=.*([a-zA-Z].*))(?=.*[0-9].*)[a-zA-Z0-9-*/+.~!@#$%^&*()]{6,20}$/,nickRegExp:/^\S{4,20}$/},H=Object(i.createContext)({}),R=H.Provider,z=n(83),P=n.n(z),M=n(82),J=n.n(M),U=Object(d.a)((function(e){return Object(h.a)({appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},container:{padding:e.spacing(2)},progress:{position:"fixed",top:0,left:0,width:"100vw",zIndex:1e4}})})),A=a.a.forwardRef((function(e,t){return Object(c.jsx)(O.a,Object(b.a)({direction:"up",ref:t},e))})),$=function(e){var t=e.open,n=e.handleClose,a=e.onSubmit,s=e.titleLabel,r=e.dialogTitle,o=e.contentPlaceHolder,j=U(),u=Object(i.useState)(""),b=Object(l.a)(u,2),d=b[0],h=b[1],k=Object(i.useState)(!1),I=Object(l.a)(k,2),T=I[0],L=I[1],N=Object(i.useState)(""),w=Object(l.a)(N,2),B=w[0],E=w[1],F=Object(i.useState)(""),W=Object(l.a)(F,2),H=W[0],R=W[1],z=Object(i.useState)(!1),P=Object(l.a)(z,2),M=P[0],$=P[1],Z=Object(i.useState)(""),D=Object(l.a)(Z,2),G=D[0],K=D[1],q=Object(i.useState)(!1),Q=Object(l.a)(q,2),V=Q[0],X=Q[1];return Object(i.useEffect)((function(){L(!1),E("")}),[d]),Object(i.useEffect)((function(){$(!1),K("")}),[H]),Object(c.jsxs)(p.a,{fullScreen:!0,open:t,onClose:n,TransitionComponent:A,children:[Object(c.jsx)(f.a,{className:j.appBar,color:"default",children:Object(c.jsxs)(x.a,{children:[Object(c.jsx)(g.a,{edge:"start",color:"inherit",onClick:n,"aria-label":"close",children:Object(c.jsx)(J.a,{})}),Object(c.jsx)(m.a,{variant:"h6",className:j.title,children:r}),Object(c.jsx)(v.a,{autoFocus:!0,color:"inherit",onClick:function(){return d?H?(X(!0),void a({content:H,title:d}).then((function(e){X(!1),n()}))):($(!0),void K("\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a")):(L(!0),void E("".concat(s,"\u4e0d\u80fd\u4e3a\u7a7a")))},children:"\u63d0\u4ea4"})]})}),Object(c.jsxs)(S.a,{container:!0,spacing:4,className:j.container,children:[Object(c.jsx)(S.a,{item:!0,xs:12,children:Object(c.jsx)(C.a,{autoFocus:!0,value:d,error:T,helperText:B,onChange:function(e){return h(e.target.value)},label:s,fullWidth:!0})}),Object(c.jsx)(S.a,{item:!0,xs:12,children:Object(c.jsx)(C.a,{label:"\u5185\u5bb9",value:H,error:M,helperText:G,onChange:function(e){return R(e.target.value)},fullWidth:!0,multiline:!0,placeholder:o})})]}),Object(c.jsx)(O.a,{in:V,direction:"down",children:Object(c.jsx)(y.a,{className:j.progress})})]})},Z=Object(d.a)((function(e){return Object(h.a)({title:{flexGrow:1},fab:{position:"absolute",bottom:e.spacing(2),right:e.spacing(2)},loginTips:{textAlign:"center",marginTop:e.spacing(10),marginBottom:e.spacing(10),color:e.palette.grey[400]}})})),D=function(){var e=Z(),t=Object(i.useState)([]),n=Object(l.a)(t,2),a=n[0],s=n[1],r=Object(j.e)(),b=Object(i.useContext)(H),d=Object(i.useState)(!1),h=Object(l.a)(d,2),O=h[0],p=h[1];return Object(i.useEffect)((function(){fetch("".concat(W.apiHost,"/api/book"),{method:"get"}).then((function(e){return e.json()})).then((function(e){s(e.books)}))}),[]),Object(c.jsxs)(k.a,{children:[Object(c.jsx)(f.a,{position:"sticky",color:"primary",children:Object(c.jsxs)(x.a,{variant:"dense",children:[Object(c.jsx)(m.a,{variant:"h6",className:e.title,children:"ZBOOK"}),Object(c.jsx)(F.a,{children:function(){return Object(c.jsx)(c.Fragment,{children:b.isIsLoginReady?Object(c.jsx)(c.Fragment,{children:b.isLogin?Object(c.jsx)(I.a,{in:b.isLogin,children:Object(c.jsx)(v.a,{color:"inherit",onClick:function(){return r.push("/center")},children:b.userInfo.nick})}):Object(c.jsx)(I.a,{in:!b.isLogin,children:Object(c.jsx)(v.a,{color:"inherit",onClick:function(){return r.push("/login")},children:"Login"})})}):Object(c.jsx)(E.a,{animation:"wave",width:60})})}})]})}),Object(c.jsx)(T.a,{children:a.map((function(e){return Object(c.jsxs)(L.a,{button:!0,onClick:function(){return t=e.id,void r.push("/book/".concat(t));var t},children:[Object(c.jsx)(N.a,{primary:e.title,secondary:e.content}),Object(c.jsx)(k.a,{children:e.author})]},e.id)}))}),Object(c.jsx)(F.a,{children:function(){return Object(c.jsxs)(c.Fragment,{children:[!b.isLogin&&a.length>0&&Object(c.jsx)(k.a,{className:e.loginTips,children:Object(c.jsxs)(m.a,{variant:"caption",children:["\u5feb\u53bb",Object(c.jsx)(w.a,{component:o.b,to:"/login",children:"\u767b\u5f55"}),"\u5f00\u59cb\u81ea\u5df1\u7684\u521b\u4f5c\u5427\uff5e"]})}),b.isLogin&&Object(c.jsx)(B.a,{className:e.fab,color:"primary",onClick:function(){return p(!0)},children:Object(c.jsx)(P.a,{})})]})}}),Object(c.jsx)($,{open:O,dialogTitle:"\u521b\u5efa\u56fe\u4e66",contentPlaceHolder:"\u672c\u4e66\u524d\u8a00\u90e8\u5206\u5185\u5bb9",titleLabel:"\u4e66\u540d",handleClose:function(){return p(!1)},onSubmit:function(e){var t=e.content,n=e.title;return fetch("".concat(W.apiHost,"/api/book"),{method:"post",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:n,content:t})}).then((function(e){return e.json()})).then((function(e){var t;1e3!==e.errCode?(t=e.book,s([].concat(Object(u.a)(a),[t]))):r.push("/login")}))}})]})},G=n(164),K=n(61),q=n(58),Q=n(59),V=n(12),X=n(72);console.log(Object(X.v4)());var Y=function(){function e(t){Object(q.a)(this,e),this.title="",this.author="",this.content="",this.sub=[],this.subMap={},this.id="",this.initialized=!1,t&&this.initialize(t),Object(V.e)(this,{initialized:V.f,id:V.f,title:V.f,author:V.f,content:V.f,sub:V.f,subMap:V.f,addSub:V.b,addSubMap:V.b,initialize:V.b})}return Object(Q.a)(e,[{key:"initialize",value:function(e){this.id=e.id||Object(X.v4)(),this.title=e.title,this.author=e.author,this.content=e.content,this.sub=e.sub||[],this.initialized=!0}},{key:"addSub",value:function(t){this.sub.push({id:t.id,title:t.title,author:t.author}),this.addSubMap(new e(t))}},{key:"addSubMap",value:function(e){this.subMap[e.id]=e}}]),e}(),_=n(161),ee=n(162),te=n(170),ne=Object(d.a)((function(e){return Object(h.a)({container:{marginTop:e.spacing(2),backgroundColor:e.palette.grey[300]},addChapterBox:{padding:e.spacing(4)}})})),ce=function(e){var t=e.data,n=e.onSelect,i=e.selectId,a=e.onSubmit,s=e.header,r=ne();return Object(c.jsxs)(k.a,{className:r.container,children:[0!==t.sub.length&&Object(c.jsx)(F.a,{children:function(){return Object(c.jsx)(T.a,{subheader:Object(c.jsx)(_.a,{disableSticky:!0,children:s}),children:t.sub.map((function(e){return Object(c.jsxs)(L.a,{button:!0,onClick:function(){return n(e.id)},children:[Object(c.jsx)(ee.a,{children:Object(c.jsx)(te.a,{checked:e.id===i})}),Object(c.jsx)(N.a,{primary:e.title})]},e.id)}))})}}),Object(c.jsx)(k.a,{className:r.addChapterBox,children:Object(c.jsx)(ae,{onSubmit:a})})]})},ie=Object(d.a)((function(e){return Object(h.a)({loginTips:{marginTop:e.spacing(1),marginBottom:e.spacing(1),color:e.palette.grey[400]}})})),ae=function(e){var t=e.onSubmit,n=Object(i.useState)(!1),a=Object(l.a)(n,2),s=a[0],r=a[1],j=Object(i.useContext)(H),u=ie();return Object(c.jsx)(F.a,{children:function(){return Object(c.jsx)(c.Fragment,{children:j.isLogin?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(v.a,{onClick:function(){return r(!0)},fullWidth:!0,variant:"outlined",children:"\u521b\u4f5c\u7ae0\u8282"}),Object(c.jsx)($,{titleLabel:"\u6807\u9898",dialogTitle:"\u6dfb\u52a0\u7ae0\u8282",contentPlaceHolder:"\u672c\u7ae0\u5185\u5bb9...",open:s,handleClose:function(){return r(!1)},onSubmit:t})]}):Object(c.jsx)(k.a,{className:u.loginTips,children:Object(c.jsxs)(m.a,{variant:"caption",children:["\u5feb\u53bb",Object(c.jsx)(w.a,{to:"/login",component:o.b,children:"\u767b\u5f55"}),"\u5f00\u59cb\u81ea\u5df1\u5bf9\u672c\u7ae0\u7684\u521b\u4f5c\u5427\uff5e"]})})})}})},se=Object(d.a)((function(e){return Object(h.a)({title:{marginTop:e.spacing(8),width:"100%",alignItems:"flex-start",flexDirection:"column"},author:{fontWeight:400,color:e.palette.grey[400],fontSize:e.spacing(2),textAlign:"right",width:"100%",marginTop:e.spacing(1)},content:{marginTop:e.spacing(6),textIndent:e.spacing(4),lineHeight:e.spacing(.22)},selectorContainer:{paddingLeft:e.spacing(3),marginTop:e.spacing(2),marginBottom:e.spacing(2)}})})),re=function e(t){var n=t.data,a=t.parent,s=t.setParentId,r=se(),o=Object(i.useState)(""),u=Object(l.a)(o,2),b=u[0],d=u[1],h=Object(i.useState)(null),O=Object(l.a)(h,2),p=O[0],f=O[1],x=Object(i.useState)(!1),g=Object(l.a)(x,2),v=g[0],S=g[1],C=Object(j.e)(),y=function(e){d(e),S(!1)};function I(e){return function(t){var n=t.content,c=t.title;return fetch("".concat(W.apiHost,"/api/chapter"),{method:"post",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:c,content:n,parentId:e.id})}).then((function(e){return e.json()})).then((function(t){1e3!==t.errCode?e.addSub(t.chapter):C.push("/login")}))}}return Object(i.useEffect)((function(){0!==n.sub.length&&d(n.sub[0].id)}),[n]),Object(i.useEffect)((function(){b&&(n.subMap[b]?f(n.subMap[b]):fetch("".concat(W.apiHost,"/api/chapter/").concat(b),{method:"get"}).then((function(e){return e.json()})).then((function(e){var t=e.chapter,c=new Y(t);f(c),n.addSubMap(c)})))}),[b,n]),Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(k.a,{className:r.content,children:n.content}),a&&Object(c.jsx)(ce,{header:"\u89c9\u5f97\u672c\u7ae0\u770b\u7684\u4e0d\u8fc7\u763e\uff1f\u770b\u770b\u5176\u4ed6\u540c\u6837\u4f18\u79c0\u7684\u7248\u672c\u5427\uff1a",onSubmit:I(a),data:a,onSelect:function(e){s&&s(e)},selectId:n.id}),p&&Object(c.jsx)(c.Fragment,{children:Object(c.jsxs)(K.a,{className:r.title,onClick:function(){return S(!v)},children:[Object(c.jsx)(m.a,{variant:"h4",children:p.title}),Object(c.jsxs)(k.a,{className:r.author,children:["author: ",p.author]})]})}),Object(c.jsx)(F.a,{children:function(){return Object(c.jsx)(c.Fragment,{children:(!b||v)&&Object(c.jsx)(ce,{header:"\u672c\u7ae0\u5176\u4ed6\u5206\u652f\uff1a",onSubmit:I(n),data:n,onSelect:y,selectId:b})})}}),Object(c.jsx)(F.a,{children:function(){return Object(c.jsx)(c.Fragment,{children:p&&Object(c.jsx)(e,{data:p,parent:n,setParentId:d},p.id)})}})]})},oe=n(163),je=function(e){var t=e.children,n=Object(oe.a)();return Object(c.jsx)(O.a,{appear:!1,direction:"down",in:!n,children:t})},ue=n(60),le=n.n(ue),be=Object(d.a)((function(e){return Object(h.a)({title:{flexGrow:1},container:{marginTop:e.spacing(3)},menuButton:{marginRight:e.spacing(2)}})})),de=function(){var e=be(),t=Object(j.f)().id,n=Object(i.useState)(null),a=Object(l.a)(n,2),s=a[0],r=a[1],o=Object(j.e)();return Object(i.useEffect)((function(){fetch("".concat(W.apiHost,"/api/chapter/").concat(t),{method:"get"}).then((function(e){return e.json()})).then((function(e){r(new Y(e.chapter))}))}),[t]),Object(c.jsxs)(k.a,{children:[Object(c.jsx)(je,{children:Object(c.jsx)(f.a,{position:"sticky",color:"default",children:Object(c.jsxs)(x.a,{variant:"dense",children:[Object(c.jsx)(g.a,{onClick:function(){return o.goBack()},edge:"start",className:e.menuButton,color:"inherit",children:Object(c.jsx)(le.a,{})}),Object(c.jsx)(m.a,{variant:"h6",className:e.title,children:s?Object(c.jsx)(I.a,{in:!!s,children:Object(c.jsx)(k.a,{children:s.title})}):Object(c.jsx)(E.a,{animation:"wave",width:100})})]})})}),Object(c.jsx)(G.a,{className:e.container,children:Object(c.jsx)(F.a,{children:function(){return Object(c.jsx)(c.Fragment,{children:s?s.initialized?Object(c.jsx)(re,{data:s}):Object(c.jsx)(k.a,{children:"error"}):Object(c.jsx)(k.a,{children:"waiting..."})})}})})]})},he=n(165),Oe=function(){var e=Object(j.e)();return Object(c.jsx)(f.a,{position:"sticky",color:"inherit",elevation:0,children:Object(c.jsx)(x.a,{variant:"dense",children:Object(c.jsx)(g.a,{onClick:function(){return e.goBack()},edge:"start",color:"inherit",children:Object(c.jsx)(le.a,{})})})})},pe=Object(d.a)((function(e){return Object(h.a)({container:{margin:"".concat(e.spacing(4),"px auto"),maxWidth:e.spacing(40)},submitBtnContainer:{position:"relative"},submitBtn:{marginTop:e.spacing(1)},buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-10,marginLeft:-12},signInBox:{display:"flex",justifyContent:"center"}})})),fe=function(){var e=Object(j.e)(),t=Object(i.useState)(""),n=Object(l.a)(t,2),a=n[0],s=n[1],r=Object(i.useState)(!1),u=Object(l.a)(r,2),b=u[0],d=u[1],h=Object(i.useState)(""),O=Object(l.a)(h,2),p=O[0],f=O[1],x=Object(i.useState)(""),g=Object(l.a)(x,2),y=g[0],I=g[1],T=Object(i.useState)(!1),L=Object(l.a)(T,2),N=L[0],B=L[1],E=Object(i.useState)(""),F=Object(l.a)(E,2),R=F[0],z=F[1],P=Object(i.useState)(!1),M=Object(l.a)(P,2),J=M[0],U=M[1],A=Object(i.useContext)(H),$=pe();return Object(i.useEffect)((function(){f(""),d(!1)}),[a]),Object(i.useEffect)((function(){z(""),B(!1)}),[y]),Object(c.jsxs)(k.a,{children:[Object(c.jsx)(Oe,{}),Object(c.jsxs)(S.a,{container:!0,className:$.container,spacing:4,children:[Object(c.jsx)(S.a,{item:!0,xs:12,children:Object(c.jsx)(C.a,{autoFocus:!0,error:b,helperText:p,value:a,onChange:function(e){return s(e.target.value)},label:"\u624b\u673a",type:"number",fullWidth:!0})}),Object(c.jsx)(S.a,{item:!0,xs:12,children:Object(c.jsx)(C.a,{error:N,helperText:R,value:y,type:"password",onChange:function(e){return I(e.target.value)},label:"\u5bc6\u7801",fullWidth:!0})}),Object(c.jsxs)(S.a,{item:!0,xs:12,className:$.submitBtnContainer,children:[Object(c.jsx)(v.a,{disabled:J,onClick:function(){if(!b&&!N){if(!a)return f("\u8bf7\u8f93\u5165\u624b\u673a\u53f7"),void d(!0);if(!W.phoneRegExp.test(a))return f("\u8bf7\u8f93\u5165\u6b63\u786e\u624b\u673a\u53f7"),void d(!0);U(!0),fetch("".concat(W.apiHost,"/api/user/sign-in"),{method:"post",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:a,password:y})}).then((function(e){return e.json()})).then((function(t){if(U(!1),!t.errCode)return e.goBack(),A.setIsLogin(!0),void A.setUserInfo(t.info);1===t.errCode?(f(t.errMsg),d(!0)):2===t.errCode&&(z(t.errMsg),B(!0))}))}},className:$.submitBtn,variant:"outlined",color:"primary",fullWidth:!0,children:"\u767b\u5f55"}),J&&Object(c.jsx)(he.a,{size:24,className:$.buttonProgress})]}),Object(c.jsx)(S.a,{item:!0,xs:12,className:$.signInBox,children:Object(c.jsxs)(m.a,{variant:"caption",children:["\u8fd8\u6ca1\u6709\u8d26\u53f7\uff0c\u7acb\u5373\u524d\u5f80",Object(c.jsx)(w.a,{component:o.b,to:"/sign-up",children:"\u6ce8\u518c"})]})})]})]})},xe=Object(d.a)((function(e){return Object(h.a)({container:{margin:"".concat(e.spacing(4),"px auto"),maxWidth:e.spacing(40)},submitBtnContainer:{position:"relative"},submitBtn:{marginTop:e.spacing(1)},buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-10,marginLeft:-12}})})),ge=function(){var e=Object(j.e)(),t=Object(i.useState)(""),n=Object(l.a)(t,2),a=n[0],s=n[1],r=Object(i.useState)(!1),o=Object(l.a)(r,2),u=o[0],b=o[1],d=Object(i.useState)(""),h=Object(l.a)(d,2),O=h[0],p=h[1],f=Object(i.useState)(""),x=Object(l.a)(f,2),g=x[0],m=x[1],y=Object(i.useState)(!1),I=Object(l.a)(y,2),T=I[0],L=I[1],N=Object(i.useState)(""),w=Object(l.a)(N,2),B=w[0],E=w[1],F=Object(i.useState)(""),R=Object(l.a)(F,2),z=R[0],P=R[1],M=Object(i.useState)(!1),J=Object(l.a)(M,2),U=J[0],A=J[1],$=Object(i.useState)(""),Z=Object(l.a)($,2),D=Z[0],G=Z[1],K=Object(i.useState)(""),q=Object(l.a)(K,2),Q=q[0],V=q[1],X=Object(i.useState)(!1),Y=Object(l.a)(X,2),_=Y[0],ee=Y[1],te=Object(i.useState)(""),ne=Object(l.a)(te,2),ce=ne[0],ie=ne[1],ae=Object(i.useState)(!1),se=Object(l.a)(ae,2),re=se[0],oe=se[1],je=Object(i.useContext)(H),ue=xe();return Object(i.useEffect)((function(){p(""),b(!1)}),[a]),Object(i.useEffect)((function(){E(""),L(!1)}),[g]),Object(i.useEffect)((function(){G(""),A(!1)}),[z]),Object(i.useEffect)((function(){ie(""),ee(!1)}),[Q]),Object(c.jsxs)(k.a,{children:[Object(c.jsx)(Oe,{}),Object(c.jsxs)(S.a,{container:!0,className:ue.container,spacing:4,children:[Object(c.jsx)(S.a,{item:!0,xs:12,children:Object(c.jsx)(C.a,{autoFocus:!0,error:u,helperText:O,value:a,onChange:function(e){return s(e.target.value)},label:"\u6635\u79f0",fullWidth:!0})}),Object(c.jsx)(S.a,{item:!0,xs:12,children:Object(c.jsx)(C.a,{error:T,helperText:B,value:g,onChange:function(e){return m(e.target.value)},label:"\u624b\u673a",type:"number",fullWidth:!0})}),Object(c.jsx)(S.a,{item:!0,xs:12,children:Object(c.jsx)(C.a,{error:U,helperText:D,value:z,type:"password",onChange:function(e){return P(e.target.value)},label:"\u5bc6\u7801",fullWidth:!0})}),Object(c.jsx)(S.a,{item:!0,xs:12,children:Object(c.jsx)(C.a,{error:_,helperText:ce,value:Q,type:"password",onChange:function(e){return V(e.target.value)},label:"\u786e\u8ba4\u5bc6\u7801",fullWidth:!0})}),Object(c.jsxs)(S.a,{item:!0,xs:12,className:ue.submitBtnContainer,children:[Object(c.jsx)(v.a,{disabled:re,onClick:function(){return g?W.phoneRegExp.test(g)?a?W.nickRegExp.test(a)?z?W.passwordRegExp.test(z)?Q?z!==Q?(ie("\u4e24\u6b21\u8f93\u5165\u5bc6\u7801\u4e0d\u76f8\u540c"),ee(!0),void A(!0)):(oe(!0),void fetch("".concat(W.apiHost,"/api/user/sign-up"),{method:"post",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:g,password:z,nick:a})}).then((function(e){return e.json()})).then((function(t){if(oe(!1),!t.errCode)return je.setIsLogin(!0),je.setUserInfo(t.info),void e.push("/");4===t.errCode?(E("\u8be5\u624b\u673a\u53f7\u5df2\u88ab\u6ce8\u518c"),L(!0)):5===t.errCode&&(p("\u8be5\u6635\u79f0\u5df2\u5b58\u5728"),b(!0))}))):(ie("\u8bf7\u8f93\u5165\u4e8c\u6b21\u786e\u8ba4\u5bc6\u7801"),void ee(!0)):(G("\u5bc6\u7801\u683c\u5f0f\u4e0d\u6b63\u786e(\u5fc5\u987b\u6709\u6570\u5b57\u548c\u5b57\u6bcd\uff0c6-20\u4e2a\u5b57\u7b26)"),void A(!0)):(G("\u8bf7\u8bbe\u7f6e\u5bc6\u7801"),void A(!0)):(p("\u6635\u79f0\u683c\u5f0f\u4e0d\u7b26\u5408\u8981\u6c42(4-20\u4e2a\u5b57\u7b26)"),void b(!0)):(p("\u8bf7\u8f93\u5165\u6635\u79f0"),void b(!0)):(E("\u8bf7\u8f93\u5165\u6b63\u786e\u624b\u673a\u53f7"),void L(!0)):(E("\u8bf7\u8f93\u5165\u624b\u673a\u53f7"),void L(!0))},className:ue.submitBtn,variant:"outlined",color:"primary",fullWidth:!0,children:"\u6ce8\u518c"}),re&&Object(c.jsx)(he.a,{size:24,className:ue.buttonProgress})]})]})]})},me=Object(d.a)((function(e){return Object(h.a)({container:{padding:e.spacing(4)}})})),ve=function(){var e=Object(i.useContext)(H),t=Object(j.e)(),n=me();function a(){fetch("".concat(W.apiHost,"/api/user/logout"),{method:"post",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"}}).then((function(n){e.setIsLogin(!1),e.setUserInfo({phone:"",nick:"",id:""}),t.replace("/")}))}return Object(i.useEffect)((function(){return Object(V.c)((function(){e.isIsLoginReady&&!e.isLogin&&t.replace("/login")}))}),[e,t]),Object(c.jsxs)(k.a,{children:[Object(c.jsx)(Oe,{}),Object(c.jsx)(F.a,{children:function(){return Object(c.jsxs)(S.a,{container:!0,spacing:2,className:n.container,children:[Object(c.jsxs)(S.a,{item:!0,xs:12,children:["\u6635\u79f0\uff1a",e.userInfo.nick]}),Object(c.jsxs)(S.a,{item:!0,xs:12,children:["\u7535\u8bdd\uff1a",e.userInfo.phone]}),Object(c.jsx)(S.a,{item:!0,xs:12,children:Object(c.jsx)(v.a,{fullWidth:!0,variant:"outlined",onClick:a,children:"\u9000\u51fa\u767b\u5f55"})})]})}})]})},Se=function(){var e=Object(i.useContext)(H);return Object(i.useEffect)((function(){fetch("".concat(W.apiHost,"/api/user/info"),{method:"get",credentials:"include"}).then((function(e){return e.json()})).then((function(t){1e3===t.errCode?e.setIsLogin(!1):(e.setIsLogin(!0),e.setUserInfo(t.info))}))}),[e]),Object(c.jsxs)(o.a,{children:[Object(c.jsx)(j.a,{path:"/",exact:!0,children:Object(c.jsx)(D,{})}),Object(c.jsx)(j.a,{path:"/book/:id",children:Object(c.jsx)(de,{})}),Object(c.jsx)(j.a,{path:"/login",children:Object(c.jsx)(fe,{})}),Object(c.jsx)(j.a,{path:"/sign-up",children:Object(c.jsx)(ge,{})}),Object(c.jsx)(j.a,{path:"/center",children:Object(c.jsx)(ve,{})})]})},Ce=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,175)).then((function(t){var n=t.getCLS,c=t.getFID,i=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),c(e),i(e),a(e),s(e)}))},ye=n(166),ke=new(function(){function e(){Object(q.a)(this,e),this.isLogin=!1,this.isIsLoginReady=!1,this.userInfo={phone:"",nick:"",id:""},Object(V.e)(this,{isLogin:V.f,isIsLoginReady:V.f,userInfo:V.f,setIsLogin:V.b,setUserInfo:V.b})}return Object(Q.a)(e,[{key:"setIsLogin",value:function(e){this.isLogin=e,this.isIsLoginReady=!0}},{key:"setUserInfo",value:function(e){this.userInfo=e}}]),e}());r.a.render(Object(c.jsxs)(R,{value:ke,children:[Object(c.jsx)(ye.a,{}),Object(c.jsx)(Se,{})]}),document.getElementById("root")),Ce()}},[[114,1,2]]]);
//# sourceMappingURL=main.fc2e50ef.chunk.js.map