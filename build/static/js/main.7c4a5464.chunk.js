(this["webpackJsonpinteractive-book"]=this["webpackJsonpinteractive-book"]||[]).push([[0],{114:function(e,t,n){"use strict";n.r(t);var c=n(2),i=n(0),a=n.n(i),o=n(11),s=n.n(o),r=n(25),j=n(15),u=n(85),l=n(8),b=n(144),d=n(172),h=n(168),O=n(149),p=n(150),f=n(52),x=n(148),g=n(152),m=n(154),v=n(157),S=n(158),C=n(159),y=n(160),k=n(156),I=n(169),T={apiHost:"",phoneRegExp:/^1[3|4|5|7|8][0-9]{9}$/,passwordRegExp:/(?=.*([a-zA-Z].*))(?=.*[0-9].*)[a-zA-Z0-9-*/+.~!@#$%^&*()]{6,20}$/,nickRegExp:/^\S{4,20}$/},N=Object(i.createContext)({}),L=N.Provider,w=n(84),B=n.n(w),E=n(51),F=n(146),z=n(173),H=n(151),R=n(153),W=n(167),P=n(155),M=n(83),J=n.n(M),U=Object(b.a)((function(e){return Object(d.a)({section:Object(E.a)(Object(E.a)({},e.typography.body1),{},{minHeight:"1.5rem",textIndent:e.spacing(4),marginTop:e.spacing(1),marginBottom:e.spacing(1)}),container:{outline:"none",border:"1px solid ".concat(e.palette.grey[600]),borderRadius:e.spacing(1),minHeight:e.spacing(50),position:"relative",marginTop:e.spacing(2),"&::before":{content:'"\u5185\u5bb9"',position:"absolute",fontSize:e.typography.body1.fontSize,color:e.palette.grey[600],left:0,bottom:"calc(100% + ".concat(e.spacing(.5),"px)")},"&:focus":{borderColor:e.palette.primary.main,"&::before":{color:e.palette.primary.main}}}})})),A=function(e){var t=e.value,n=e.onChange,a=U(),o=Object(i.useRef)(),s=Object(i.useState)([]),r=Object(l.a)(s,2),j=r[0],u=r[1];return Object(i.useEffect)((function(){u(t)}),[]),Object(c.jsxs)("div",{ref:o,contentEditable:!0,className:a.container,suppressContentEditableWarning:!0,onInput:function(e){n(Array.prototype.map.call(e.target.children,(function(e){return e.innerText})))},children:[0===j.length&&Object(c.jsx)(h.a,{className:a.section}),j.map((function(e){return Object(c.jsx)(h.a,{className:a.section,children:e})}))]})},$=Object(b.a)((function(e){return Object(d.a)({appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},container:{padding:e.spacing(2)},progress:{position:"fixed",top:0,left:0,width:"100vw",zIndex:1e4},contentHeader:{fontSize:e.typography.body1.fontSize,color:e.palette.grey[700]}})})),Z=a.a.forwardRef((function(e,t){return Object(c.jsx)(F.a,Object(E.a)({direction:"up",ref:t},e))})),D=function(e){var t=e.open,n=e.handleClose,a=e.onSubmit,o=e.titleLabel,s=e.dialogTitle,r=(e.contentPlaceHolder,$()),j=Object(i.useState)(""),u=Object(l.a)(j,2),b=u[0],d=u[1],h=Object(i.useState)(!1),x=Object(l.a)(h,2),m=x[0],v=x[1],S=Object(i.useState)(""),C=Object(l.a)(S,2),y=C[0],k=C[1],I=Object(i.useState)([]),T=Object(l.a)(I,2),N=T[0],L=T[1],w=Object(i.useState)(!1),B=Object(l.a)(w,2),E=(B[0],B[1]),M=Object(i.useState)(""),U=Object(l.a)(M,2),D=(U[0],U[1]),G=Object(i.useState)(!1),K=Object(l.a)(G,2),q=K[0],Q=K[1];return Object(i.useEffect)((function(){v(!1),k("")}),[b]),Object(i.useEffect)((function(){E(!1),D("")}),[N]),Object(c.jsxs)(z.a,{fullScreen:!0,open:t,onClose:n,TransitionComponent:Z,children:[Object(c.jsx)(O.a,{className:r.appBar,color:"default",children:Object(c.jsxs)(p.a,{children:[Object(c.jsx)(H.a,{edge:"start",color:"inherit",onClick:n,"aria-label":"close",children:Object(c.jsx)(J.a,{})}),Object(c.jsx)(f.a,{variant:"h6",className:r.title,children:s}),Object(c.jsx)(g.a,{autoFocus:!0,color:"inherit",onClick:function(){return b?0===N.length?(E(!0),void D("\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a")):(Q(!0),void a({content:N,title:b}).then((function(e){Q(!1),n()}))):(v(!0),void k("".concat(o,"\u4e0d\u80fd\u4e3a\u7a7a")))},children:"\u63d0\u4ea4"})]})}),Object(c.jsxs)(R.a,{container:!0,spacing:4,className:r.container,children:[Object(c.jsx)(R.a,{item:!0,xs:12,children:Object(c.jsx)(W.a,{autoFocus:!0,value:b,error:m,helperText:y,onChange:function(e){return d(e.target.value)},label:o,fullWidth:!0})}),Object(c.jsx)(R.a,{item:!0,xs:12,children:Object(c.jsx)(A,{value:N,onChange:L})})]}),Object(c.jsx)(F.a,{in:q,direction:"down",children:Object(c.jsx)(P.a,{className:r.progress})})]})},G=Object(b.a)((function(e){return Object(d.a)({title:{flexGrow:1},fab:{position:"absolute",bottom:e.spacing(2),right:e.spacing(2)},loginTips:{textAlign:"center",marginTop:e.spacing(10),marginBottom:e.spacing(10),color:e.palette.grey[400]}})})),K=function(){var e=G(),t=Object(i.useState)([]),n=Object(l.a)(t,2),a=n[0],o=n[1],s=Object(j.e)(),b=Object(i.useContext)(N),d=Object(i.useState)(!1),L=Object(l.a)(d,2),w=L[0],E=L[1];return Object(i.useEffect)((function(){fetch("".concat(T.apiHost,"/api/book"),{method:"get"}).then((function(e){return e.json()})).then((function(e){o(e.books)}))}),[]),Object(c.jsxs)(h.a,{children:[Object(c.jsx)(O.a,{position:"sticky",color:"primary",children:Object(c.jsxs)(p.a,{variant:"dense",children:[Object(c.jsx)(f.a,{variant:"h6",className:e.title,children:"ZBOOK"}),Object(c.jsx)(I.a,{children:function(){return Object(c.jsx)(c.Fragment,{children:b.isIsLoginReady?Object(c.jsx)(c.Fragment,{children:b.isLogin?Object(c.jsx)(x.a,{in:b.isLogin,children:Object(c.jsx)(g.a,{color:"inherit",onClick:function(){return s.push("/center")},children:b.userInfo.nick})}):Object(c.jsx)(x.a,{in:!b.isLogin,children:Object(c.jsx)(g.a,{color:"inherit",onClick:function(){return s.push("/login")},children:"Login"})})}):Object(c.jsx)(k.a,{animation:"wave",width:60})})}})]})}),Object(c.jsx)(m.a,{children:a.map((function(e){return Object(c.jsxs)(v.a,{button:!0,onClick:function(){return t=e.id,void s.push("/book/".concat(t));var t},children:[Object(c.jsx)(S.a,{primary:e.title,secondary:e.content[0]}),Object(c.jsx)(h.a,{children:e.author})]},e.id)}))}),Object(c.jsx)(I.a,{children:function(){return Object(c.jsxs)(c.Fragment,{children:[!b.isLogin&&a.length>0&&Object(c.jsx)(h.a,{className:e.loginTips,children:Object(c.jsxs)(f.a,{variant:"caption",children:["\u5feb\u53bb",Object(c.jsx)(C.a,{component:r.b,to:"/login",children:"\u767b\u5f55"}),"\u5f00\u59cb\u81ea\u5df1\u7684\u521b\u4f5c\u5427\uff5e"]})}),b.isLogin&&Object(c.jsx)(y.a,{className:e.fab,color:"primary",onClick:function(){return E(!0)},children:Object(c.jsx)(B.a,{})})]})}}),Object(c.jsx)(D,{open:w,dialogTitle:"\u521b\u5efa\u56fe\u4e66",contentPlaceHolder:"\u672c\u4e66\u524d\u8a00\u90e8\u5206\u5185\u5bb9",titleLabel:"\u4e66\u540d",handleClose:function(){return E(!1)},onSubmit:function(e){var t=e.content,n=e.title;return fetch("".concat(T.apiHost,"/api/book"),{method:"post",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:n,content:t})}).then((function(e){return e.json()})).then((function(e){var t;1e3!==e.errCode?(t=e.book,o([].concat(Object(u.a)(a),[t]))):s.push("/login")}))}})]})},q=n(164),Q=n(62),V=n(59),X=n(60),Y=n(12),_=n(73);console.log(Object(_.v4)());var ee=function(){function e(t){Object(V.a)(this,e),this.title="",this.author="",this.content=[],this.sub=[],this.subMap={},this.id="",this.initialized=!1,t&&this.initialize(t),Object(Y.e)(this,{initialized:Y.f,id:Y.f,title:Y.f,author:Y.f,content:Y.f,sub:Y.f,subMap:Y.f,addSub:Y.b,addSubMap:Y.b,initialize:Y.b})}return Object(X.a)(e,[{key:"initialize",value:function(e){this.id=e.id||Object(_.v4)(),this.title=e.title,this.author=e.author,this.content=e.content,this.sub=e.sub||[],this.initialized=!0}},{key:"addSub",value:function(t){this.sub.push({id:t.id,title:t.title,author:t.author}),this.addSubMap(new e(t))}},{key:"addSubMap",value:function(e){this.subMap[e.id]=e}}]),e}(),te=n(161),ne=n(162),ce=n(170),ie=Object(b.a)((function(e){return Object(d.a)({container:{marginTop:e.spacing(2),backgroundColor:e.palette.grey[300]},addChapterBox:{padding:e.spacing(4)}})})),ae=function(e){var t=e.data,n=e.onSelect,i=e.selectId,a=e.onSubmit,o=e.header,s=ie();return Object(c.jsxs)(h.a,{className:s.container,children:[0!==t.sub.length&&Object(c.jsx)(I.a,{children:function(){return Object(c.jsx)(m.a,{subheader:Object(c.jsx)(te.a,{disableSticky:!0,children:o}),children:t.sub.map((function(e){return Object(c.jsxs)(v.a,{button:!0,onClick:function(){return n(e.id)},children:[Object(c.jsx)(ne.a,{children:Object(c.jsx)(ce.a,{checked:e.id===i})}),Object(c.jsx)(S.a,{primary:e.title})]},e.id)}))})}}),Object(c.jsx)(h.a,{className:s.addChapterBox,children:Object(c.jsx)(se,{onSubmit:a})})]})},oe=Object(b.a)((function(e){return Object(d.a)({loginTips:{marginTop:e.spacing(1),marginBottom:e.spacing(1),color:e.palette.grey[400]}})})),se=function(e){var t=e.onSubmit,n=Object(i.useState)(!1),a=Object(l.a)(n,2),o=a[0],s=a[1],j=Object(i.useContext)(N),u=oe();return Object(c.jsx)(I.a,{children:function(){return Object(c.jsx)(c.Fragment,{children:j.isLogin?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(g.a,{onClick:function(){return s(!0)},fullWidth:!0,variant:"outlined",children:"\u521b\u4f5c\u7ae0\u8282"}),Object(c.jsx)(D,{titleLabel:"\u6807\u9898",dialogTitle:"\u6dfb\u52a0\u7ae0\u8282",contentPlaceHolder:"\u672c\u7ae0\u5185\u5bb9...",open:o,handleClose:function(){return s(!1)},onSubmit:t})]}):Object(c.jsx)(h.a,{className:u.loginTips,children:Object(c.jsxs)(f.a,{variant:"caption",children:["\u5feb\u53bb",Object(c.jsx)(C.a,{to:"/login",component:r.b,children:"\u767b\u5f55"}),"\u5f00\u59cb\u81ea\u5df1\u5bf9\u672c\u7ae0\u7684\u521b\u4f5c\u5427\uff5e"]})})})}})},re=Object(b.a)((function(e){return Object(d.a)({title:{marginTop:e.spacing(8),width:"100%",alignItems:"flex-start",flexDirection:"column"},author:{fontWeight:400,color:e.palette.grey[400],fontSize:e.spacing(2),textAlign:"right",width:"100%",marginTop:e.spacing(1)},content:{marginTop:e.spacing(6),textIndent:e.spacing(4),lineHeight:e.spacing(.22)},selectorContainer:{paddingLeft:e.spacing(3),marginTop:e.spacing(2),marginBottom:e.spacing(2)}})})),je=function e(t){var n=t.data,a=t.parent,o=t.setParentId,s=re(),r=Object(i.useState)(""),u=Object(l.a)(r,2),b=u[0],d=u[1],O=Object(i.useState)(null),p=Object(l.a)(O,2),x=p[0],g=p[1],m=Object(i.useState)(!1),v=Object(l.a)(m,2),S=v[0],C=v[1],y=Object(j.e)(),k=function(e){d(e),C(!1)};function N(e){return function(t){var n=t.content,c=t.title;return fetch("".concat(T.apiHost,"/api/chapter"),{method:"post",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:c,content:n,parentId:e.id})}).then((function(e){return e.json()})).then((function(t){1e3!==t.errCode?e.addSub(t.chapter):y.push("/login")}))}}return Object(i.useEffect)((function(){0!==n.sub.length&&d(n.sub[0].id)}),[n]),Object(i.useEffect)((function(){b&&(n.subMap[b]?g(n.subMap[b]):fetch("".concat(T.apiHost,"/api/chapter/").concat(b),{method:"get"}).then((function(e){return e.json()})).then((function(e){var t=e.chapter,c=new ee(t);g(c),n.addSubMap(c)})))}),[b,n]),Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(h.a,{className:s.content,children:n.content.map((function(e){return Object(c.jsx)(h.a,{children:e})}))}),a&&Object(c.jsx)(ae,{header:"\u89c9\u5f97\u672c\u7ae0\u770b\u7684\u4e0d\u8fc7\u763e\uff1f\u770b\u770b\u5176\u4ed6\u540c\u6837\u4f18\u79c0\u7684\u7248\u672c\u5427\uff1a",onSubmit:N(a),data:a,onSelect:function(e){o&&o(e)},selectId:n.id}),x&&Object(c.jsx)(c.Fragment,{children:Object(c.jsxs)(Q.a,{className:s.title,onClick:function(){return C(!S)},children:[Object(c.jsx)(f.a,{variant:"h4",children:x.title}),Object(c.jsxs)(h.a,{className:s.author,children:["author: ",x.author]})]})}),Object(c.jsx)(I.a,{children:function(){return Object(c.jsx)(c.Fragment,{children:(!b||S)&&Object(c.jsx)(ae,{header:"\u672c\u7ae0\u5176\u4ed6\u5206\u652f\uff1a",onSubmit:N(n),data:n,onSelect:k,selectId:b})})}}),Object(c.jsx)(I.a,{children:function(){return Object(c.jsx)(c.Fragment,{children:x&&Object(c.jsx)(e,{data:x,parent:n,setParentId:d},x.id)})}})]})},ue=n(163),le=function(e){var t=e.children,n=Object(ue.a)();return Object(c.jsx)(F.a,{appear:!1,direction:"down",in:!n,children:t})},be=n(61),de=n.n(be),he=Object(b.a)((function(e){return Object(d.a)({title:{flexGrow:1},container:{marginTop:e.spacing(3)},menuButton:{marginRight:e.spacing(2)}})})),Oe=function(){var e=he(),t=Object(j.f)().id,n=Object(i.useState)(null),a=Object(l.a)(n,2),o=a[0],s=a[1],r=Object(j.e)();return Object(i.useEffect)((function(){fetch("".concat(T.apiHost,"/api/chapter/").concat(t),{method:"get"}).then((function(e){return e.json()})).then((function(e){s(new ee(e.chapter))}))}),[t]),Object(c.jsxs)(h.a,{children:[Object(c.jsx)(le,{children:Object(c.jsx)(O.a,{position:"sticky",color:"default",children:Object(c.jsxs)(p.a,{variant:"dense",children:[Object(c.jsx)(H.a,{onClick:function(){return r.goBack()},edge:"start",className:e.menuButton,color:"inherit",children:Object(c.jsx)(de.a,{})}),Object(c.jsx)(f.a,{variant:"h6",className:e.title,children:o?Object(c.jsx)(x.a,{in:!!o,children:Object(c.jsx)(h.a,{children:o.title})}):Object(c.jsx)(k.a,{animation:"wave",width:100})})]})})}),Object(c.jsx)(q.a,{className:e.container,children:Object(c.jsx)(I.a,{children:function(){return Object(c.jsx)(c.Fragment,{children:o?o.initialized?Object(c.jsx)(je,{data:o}):Object(c.jsx)(h.a,{children:"error"}):Object(c.jsx)(h.a,{children:"waiting..."})})}})})]})},pe=n(165),fe=function(){var e=Object(j.e)();return Object(c.jsx)(O.a,{position:"sticky",color:"inherit",elevation:0,children:Object(c.jsx)(p.a,{variant:"dense",children:Object(c.jsx)(H.a,{onClick:function(){return e.goBack()},edge:"start",color:"inherit",children:Object(c.jsx)(de.a,{})})})})},xe=Object(b.a)((function(e){return Object(d.a)({container:{margin:"".concat(e.spacing(4),"px auto"),maxWidth:e.spacing(40)},submitBtnContainer:{position:"relative"},submitBtn:{marginTop:e.spacing(1)},buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-10,marginLeft:-12},signInBox:{display:"flex",justifyContent:"center"}})})),ge=function(){var e=Object(j.e)(),t=Object(i.useState)(""),n=Object(l.a)(t,2),a=n[0],o=n[1],s=Object(i.useState)(!1),u=Object(l.a)(s,2),b=u[0],d=u[1],O=Object(i.useState)(""),p=Object(l.a)(O,2),x=p[0],m=p[1],v=Object(i.useState)(""),S=Object(l.a)(v,2),y=S[0],k=S[1],I=Object(i.useState)(!1),L=Object(l.a)(I,2),w=L[0],B=L[1],E=Object(i.useState)(""),F=Object(l.a)(E,2),z=F[0],H=F[1],P=Object(i.useState)(!1),M=Object(l.a)(P,2),J=M[0],U=M[1],A=Object(i.useContext)(N),$=xe();return Object(i.useEffect)((function(){m(""),d(!1)}),[a]),Object(i.useEffect)((function(){H(""),B(!1)}),[y]),Object(c.jsxs)(h.a,{children:[Object(c.jsx)(fe,{}),Object(c.jsxs)(R.a,{container:!0,className:$.container,spacing:4,children:[Object(c.jsx)(R.a,{item:!0,xs:12,children:Object(c.jsx)(W.a,{autoFocus:!0,error:b,helperText:x,value:a,onChange:function(e){return o(e.target.value)},label:"\u624b\u673a",type:"number",fullWidth:!0})}),Object(c.jsx)(R.a,{item:!0,xs:12,children:Object(c.jsx)(W.a,{error:w,helperText:z,value:y,type:"password",onChange:function(e){return k(e.target.value)},label:"\u5bc6\u7801",fullWidth:!0})}),Object(c.jsxs)(R.a,{item:!0,xs:12,className:$.submitBtnContainer,children:[Object(c.jsx)(g.a,{disabled:J,onClick:function(){if(!b&&!w){if(!a)return m("\u8bf7\u8f93\u5165\u624b\u673a\u53f7"),void d(!0);if(!T.phoneRegExp.test(a))return m("\u8bf7\u8f93\u5165\u6b63\u786e\u624b\u673a\u53f7"),void d(!0);U(!0),fetch("".concat(T.apiHost,"/api/user/sign-in"),{method:"post",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:a,password:y})}).then((function(e){return e.json()})).then((function(t){if(U(!1),!t.errCode)return e.goBack(),A.setIsLogin(!0),void A.setUserInfo(t.info);1===t.errCode?(m(t.errMsg),d(!0)):2===t.errCode&&(H(t.errMsg),B(!0))}))}},className:$.submitBtn,variant:"outlined",color:"primary",fullWidth:!0,children:"\u767b\u5f55"}),J&&Object(c.jsx)(pe.a,{size:24,className:$.buttonProgress})]}),Object(c.jsx)(R.a,{item:!0,xs:12,className:$.signInBox,children:Object(c.jsxs)(f.a,{variant:"caption",children:["\u8fd8\u6ca1\u6709\u8d26\u53f7\uff0c\u7acb\u5373\u524d\u5f80",Object(c.jsx)(C.a,{component:r.b,to:"/sign-up",children:"\u6ce8\u518c"})]})})]})]})},me=Object(b.a)((function(e){return Object(d.a)({container:{margin:"".concat(e.spacing(4),"px auto"),maxWidth:e.spacing(40)},submitBtnContainer:{position:"relative"},submitBtn:{marginTop:e.spacing(1)},buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-10,marginLeft:-12}})})),ve=function(){var e=Object(j.e)(),t=Object(i.useState)(""),n=Object(l.a)(t,2),a=n[0],o=n[1],s=Object(i.useState)(!1),r=Object(l.a)(s,2),u=r[0],b=r[1],d=Object(i.useState)(""),O=Object(l.a)(d,2),p=O[0],f=O[1],x=Object(i.useState)(""),m=Object(l.a)(x,2),v=m[0],S=m[1],C=Object(i.useState)(!1),y=Object(l.a)(C,2),k=y[0],I=y[1],L=Object(i.useState)(""),w=Object(l.a)(L,2),B=w[0],E=w[1],F=Object(i.useState)(""),z=Object(l.a)(F,2),H=z[0],P=z[1],M=Object(i.useState)(!1),J=Object(l.a)(M,2),U=J[0],A=J[1],$=Object(i.useState)(""),Z=Object(l.a)($,2),D=Z[0],G=Z[1],K=Object(i.useState)(""),q=Object(l.a)(K,2),Q=q[0],V=q[1],X=Object(i.useState)(!1),Y=Object(l.a)(X,2),_=Y[0],ee=Y[1],te=Object(i.useState)(""),ne=Object(l.a)(te,2),ce=ne[0],ie=ne[1],ae=Object(i.useState)(!1),oe=Object(l.a)(ae,2),se=oe[0],re=oe[1],je=Object(i.useContext)(N),ue=me();return Object(i.useEffect)((function(){f(""),b(!1)}),[a]),Object(i.useEffect)((function(){E(""),I(!1)}),[v]),Object(i.useEffect)((function(){G(""),A(!1)}),[H]),Object(i.useEffect)((function(){ie(""),ee(!1)}),[Q]),Object(c.jsxs)(h.a,{children:[Object(c.jsx)(fe,{}),Object(c.jsxs)(R.a,{container:!0,className:ue.container,spacing:4,children:[Object(c.jsx)(R.a,{item:!0,xs:12,children:Object(c.jsx)(W.a,{autoFocus:!0,error:u,helperText:p,value:a,onChange:function(e){return o(e.target.value)},label:"\u6635\u79f0",fullWidth:!0})}),Object(c.jsx)(R.a,{item:!0,xs:12,children:Object(c.jsx)(W.a,{error:k,helperText:B,value:v,onChange:function(e){return S(e.target.value)},label:"\u624b\u673a",type:"number",fullWidth:!0})}),Object(c.jsx)(R.a,{item:!0,xs:12,children:Object(c.jsx)(W.a,{error:U,helperText:D,value:H,type:"password",onChange:function(e){return P(e.target.value)},label:"\u5bc6\u7801",fullWidth:!0})}),Object(c.jsx)(R.a,{item:!0,xs:12,children:Object(c.jsx)(W.a,{error:_,helperText:ce,value:Q,type:"password",onChange:function(e){return V(e.target.value)},label:"\u786e\u8ba4\u5bc6\u7801",fullWidth:!0})}),Object(c.jsxs)(R.a,{item:!0,xs:12,className:ue.submitBtnContainer,children:[Object(c.jsx)(g.a,{disabled:se,onClick:function(){return v?T.phoneRegExp.test(v)?a?T.nickRegExp.test(a)?H?T.passwordRegExp.test(H)?Q?H!==Q?(ie("\u4e24\u6b21\u8f93\u5165\u5bc6\u7801\u4e0d\u76f8\u540c"),ee(!0),void A(!0)):(re(!0),void fetch("".concat(T.apiHost,"/api/user/sign-up"),{method:"post",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:v,password:H,nick:a})}).then((function(e){return e.json()})).then((function(t){if(re(!1),!t.errCode)return je.setIsLogin(!0),je.setUserInfo(t.info),void e.push("/");4===t.errCode?(E("\u8be5\u624b\u673a\u53f7\u5df2\u88ab\u6ce8\u518c"),I(!0)):5===t.errCode&&(f("\u8be5\u6635\u79f0\u5df2\u5b58\u5728"),b(!0))}))):(ie("\u8bf7\u8f93\u5165\u4e8c\u6b21\u786e\u8ba4\u5bc6\u7801"),void ee(!0)):(G("\u5bc6\u7801\u683c\u5f0f\u4e0d\u6b63\u786e(\u5fc5\u987b\u6709\u6570\u5b57\u548c\u5b57\u6bcd\uff0c6-20\u4e2a\u5b57\u7b26)"),void A(!0)):(G("\u8bf7\u8bbe\u7f6e\u5bc6\u7801"),void A(!0)):(f("\u6635\u79f0\u683c\u5f0f\u4e0d\u7b26\u5408\u8981\u6c42(4-20\u4e2a\u5b57\u7b26)"),void b(!0)):(f("\u8bf7\u8f93\u5165\u6635\u79f0"),void b(!0)):(E("\u8bf7\u8f93\u5165\u6b63\u786e\u624b\u673a\u53f7"),void I(!0)):(E("\u8bf7\u8f93\u5165\u624b\u673a\u53f7"),void I(!0))},className:ue.submitBtn,variant:"outlined",color:"primary",fullWidth:!0,children:"\u6ce8\u518c"}),se&&Object(c.jsx)(pe.a,{size:24,className:ue.buttonProgress})]})]})]})},Se=Object(b.a)((function(e){return Object(d.a)({container:{padding:e.spacing(4)}})})),Ce=function(){var e=Object(i.useContext)(N),t=Object(j.e)(),n=Se();function a(){fetch("".concat(T.apiHost,"/api/user/logout"),{method:"post",mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"}}).then((function(n){e.setIsLogin(!1),e.setUserInfo({phone:"",nick:"",id:""}),t.replace("/")}))}return Object(i.useEffect)((function(){return Object(Y.c)((function(){e.isIsLoginReady&&!e.isLogin&&t.replace("/login")}))}),[e,t]),Object(c.jsxs)(h.a,{children:[Object(c.jsx)(fe,{}),Object(c.jsx)(I.a,{children:function(){return Object(c.jsxs)(R.a,{container:!0,spacing:2,className:n.container,children:[Object(c.jsxs)(R.a,{item:!0,xs:12,children:["\u6635\u79f0\uff1a",e.userInfo.nick]}),Object(c.jsxs)(R.a,{item:!0,xs:12,children:["\u7535\u8bdd\uff1a",e.userInfo.phone]}),Object(c.jsx)(R.a,{item:!0,xs:12,children:Object(c.jsx)(g.a,{fullWidth:!0,variant:"outlined",onClick:a,children:"\u9000\u51fa\u767b\u5f55"})})]})}})]})},ye=function(){var e=Object(i.useContext)(N);return Object(i.useEffect)((function(){fetch("".concat(T.apiHost,"/api/user/info"),{method:"get",credentials:"include"}).then((function(e){return e.json()})).then((function(t){1e3===t.errCode?e.setIsLogin(!1):(e.setIsLogin(!0),e.setUserInfo(t.info))}))}),[e]),Object(c.jsxs)(r.a,{children:[Object(c.jsx)(j.a,{path:"/",exact:!0,children:Object(c.jsx)(K,{})}),Object(c.jsx)(j.a,{path:"/book/:id",children:Object(c.jsx)(Oe,{})}),Object(c.jsx)(j.a,{path:"/login",children:Object(c.jsx)(ge,{})}),Object(c.jsx)(j.a,{path:"/sign-up",children:Object(c.jsx)(ve,{})}),Object(c.jsx)(j.a,{path:"/center",children:Object(c.jsx)(Ce,{})})]})},ke=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,175)).then((function(t){var n=t.getCLS,c=t.getFID,i=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),c(e),i(e),a(e),o(e)}))},Ie=n(166),Te=new(function(){function e(){Object(V.a)(this,e),this.isLogin=!1,this.isIsLoginReady=!1,this.userInfo={phone:"",nick:"",id:""},Object(Y.e)(this,{isLogin:Y.f,isIsLoginReady:Y.f,userInfo:Y.f,setIsLogin:Y.b,setUserInfo:Y.b})}return Object(X.a)(e,[{key:"setIsLogin",value:function(e){this.isLogin=e,this.isIsLoginReady=!0}},{key:"setUserInfo",value:function(e){this.userInfo=e}}]),e}());s.a.render(Object(c.jsxs)(L,{value:Te,children:[Object(c.jsx)(Ie.a,{}),Object(c.jsx)(ye,{})]}),document.getElementById("root")),ke()}},[[114,1,2]]]);
//# sourceMappingURL=main.7c4a5464.chunk.js.map